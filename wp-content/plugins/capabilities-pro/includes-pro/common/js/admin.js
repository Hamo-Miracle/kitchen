jQuery(document).ready(function(e){e(document).on("keydown",".ppc-add-custom-row-body input[type='text']",function(e){return 13!==e.keyCode}),e(document).on("click",".edit-features-custom-item",function(t){t.preventDefault();var a=e(this),s=a.attr("data-section"),c=a.attr("data-id"),i=a.attr("data-label"),r=a.attr("data-element"),o=e(".ppc-custom-features-table."+s);""!=c&&(e("."+s+".editing-custom-item").show(),e("."+s+".editing-custom-item .title").html(i),o.find(".cancel-custom-features-item-edit").attr("style","visibility: visible"),o.find(".submit-button").html(o.find(".submit-button").attr("data-edit")),o.find(".custom-edit-id").val(c),o.find(".form-label").val(i),o.find(".form-element").val(r),o.find(".form-label").trigger("change"),e([document.documentElement,document.body]).animate({scrollTop:o.offset().top-150},"fast"))}),e(document).on("click",".cancel-custom-features-item-edit",function(t){t.preventDefault();var a=e(this).attr("data-section"),s=e(".ppc-custom-features-table."+a);e("."+a+".editing-custom-item").hide(),e("."+a+".editing-custom-item .title").html(""),s.find(".cancel-custom-features-item-edit").attr("style",""),s.find(".submit-button").html(s.find(".submit-button").attr("data-add")),s.find(".custom-edit-id").val(""),s.find(".form-label").val(""),s.find(".form-element").val(""),s.find(".form-label").trigger("change")}),e(document).on("click",".ppc-feature-gutenberg-new-submit, .ppc-feature-classic-new-submit",function(t){t.preventDefault();var a,s,c,i,r,o=e(this);e(".ppc-feature-submit-form-error").remove(),o.attr("disabled",!0),e(".ppc-feature-post-loader").addClass("is-active"),o.hasClass("ppc-feature-gutenberg-new-submit")?(a="ppc_submit_feature_gutenberg_by_ajax",c=o.closest(".ppc-add-custom-row-body").find(".ppc-feature-gutenberg-new-name").val(),i=o.closest(".ppc-add-custom-row-body").find(".ppc-feature-gutenberg-new-ids").val()):(a="ppc_submit_feature_classic_by_ajax",c=o.closest(".ppc-add-custom-row-body").find(".ppc-feature-classic-new-name").val(),i=o.closest(".ppc-add-custom-row-body").find(".ppc-feature-classic-new-ids").val()),r=o.closest("tr").find(".custom-edit-id").val();var n={action:a,security:s=o.closest(".ppc-add-custom-row-body").find(".ppc-feature-submit-form-nonce").val(),custom_label:c,custom_element:i,item_id:r};e.post(ajaxurl,n,function(t){if("error"==t.status)o.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:red;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(2e3).fadeOut("slow");else{var a,s,c,i,n;e(".ppc-editor-features-submit").attr("disabled",!1),e(".ppc-save-button-warning").remove(),o.hasClass("ppc-feature-gutenberg-new-submit")?(n=".editor-features-gutenberg",e(".ppc-feature-gutenberg-new-name").val(""),e(".ppc-feature-gutenberg-new-ids").val("")):(n=".editor-features-classic",e(".ppc-feature-classic-new-name").val(""),e(".ppc-feature-classic-new-ids").val("")),o.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:green;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(5e3).fadeOut("slow"),setTimeout(function(){e(".ppc-menu-overlay-item").removeClass("ppc-menu-overlay-item")},5e3),e(n).each(function(){c=(a=e(this)).attr("data-post_type"),i=e(".ppc-capabilities-tab-active").attr("data-slug")===c?"checked":"",s='<tr class="ppc-menu-row parent-menu ppc-menu-overlay-item custom-item-'+t.content.element_id+'"><td class="restrict-column ppc-menu-checkbox"><input id="check-item-'+c+"-"+t.content.element_id+'" class="check-item" type="checkbox" name="'+t.content.data_name_prefix+c+'[]" value="'+t.content.element_id+'" '+i+' /></td><td class="menu-column ppc-menu-item custom-item-row ppc-flex"><div class="ppc-flex-item"><div><span class="gutenberg menu-item-link"><strong><i class="dashicons dashicons-arrow-right"></i> '+t.content.custom_label+'</span></div><div class="custom-item-output"><div class="custom-item-display">'+t.content.custom_element+'</div></div></div><div class="ppc-flex-item"><div class="button view-custom-item">'+t.content.view_text+'</div><div class="button edit-features-custom-item" data-section="'+t.content.section+'" data-label="'+t.content.custom_label+'" data-element="'+t.content.custom_element+'" data-id="'+t.content.element_id+'">'+t.content.edit_text+'</div><div class="button ppc-custom-features-delete feature-red" data-parent="'+t.content.data_parent+'" data-id="'+t.content.element_id+'">'+t.content.delete_text+"</div></div></div></td></tr>",""!==r?(o.closest("tr").find(".cancel-custom-features-item-edit").trigger("click"),a.find(".custom-item-"+r).replaceWith(s)):a.find("tr:last").after(s)})}e(".ppc-feature-post-loader").removeClass("is-active"),o.attr("disabled",!1)})}),e(document).on("click",".ppc-custom-features-delete",function(t){if(confirm(cmeAdmin.deleteWarning)){var a=e(this),s=a.attr("data-id"),c=a.attr("data-parent"),i=e(".ppc-feature-submit-form-nonce").val();e("div[data-id='"+s+"']").each(function(){e(this).closest(".ppc-menu-row").fadeOut(300)}),e.post(ajaxurl,{action:"ppc_delete_custom_post_features_by_ajax",security:i,delete_id:s,delete_parent:c},function(t){"error"==t.status&&(e("div[data-id='"+s+"']").each(function(){e(this).closest(".ppc-menu-row").show()}),alert(t.message))})}}),e(document).on("keyup paste",".ppc-add-custom-row-body input, .ppc-add-custom-row-body textarea",function(t){var a=!1;e(".ppc-save-button-warning").remove(),e(".ppc-add-custom-row-body .left input, .ppc-add-custom-row-body .right textarea").each(function(){""!==e(this).val()&&e(this).val().replace(/\s/g,"").length&&(a=!0)}),a?e(this).closest("form").find("input[type=submit]").attr("disabled",!0).after('<span class="ppc-save-button-warning">'+cmeAdmin.saveWarning+"</span>"):e(this).closest("form").find("input[type=submit]").attr("disabled",!1)}),e(document).on("click",".ppc-feature-css-hide-new-submit",function(t){t.preventDefault(),custom_label=e(".ppc-feature-css-hide-new-name").val(),custom_element=e(".ppc-feature-css-hide-new-element").val(),item_id="",security=e(".ppc-feature-submit-form-nonce").val(),item_id=(button=e(this)).closest("tr").find(".custom-edit-id").val(),e(".ppc-feature-submit-form-error").remove(),button.attr("disabled",!0),e(".ppc-feature-post-loader").addClass("is-active");var a={action:"ppc_submit_feature_css_hide_by_ajax",security:security,custom_label:custom_label,custom_element:custom_element,item_id:item_id};e.post(ajaxurl,a,function(t){if("error"==t.status)button.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:red;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(2e3).fadeOut("slow");else{var a=e(".parent-menu.hidecsselement"),s=e(".child-menu.hidecsselement");e(".ppc-save-button-warning").remove(),e(".ppc-feature-css-hide-new-name").val(""),e(".ppc-feature-css-hide-new-element").val(""),button.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:green;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(5e3).fadeOut("slow"),setTimeout(function(){e(".ppc-menu-overlay-item").removeClass("ppc-menu-overlay-item")},5e3),s.length>0?""!==item_id?(button.closest("tr").find(".cancel-custom-features-item-edit").trigger("click"),e(".child-menu.hidecsselement.custom-item-"+item_id).replaceWith(t.content)):e(".child-menu.hidecsselement:last").after(t.content):a.after(t.content)}button.closest("form").find("input[type=submit]").attr("disabled",!1),e(".ppc-feature-post-loader").removeClass("is-active"),button.attr("disabled",!1)})}),e(document).on("click",".ppc-custom-features-css-delete",function(t){if(confirm(cmeAdmin.deleteWarning)){var a=e(this),s=a.attr("data-id"),c=e(".ppc-feature-submit-form-nonce").val();a.closest(".ppc-menu-row").fadeOut(300),e.post(ajaxurl,{action:"ppc_delete_feature_css_hide_item_by_ajax",security:c,delete_id:s},function(e){"error"==e.status&&(a.closest(".ppc-menu-row").show(),alert(e.message))})}}),e(document).on("click",".ppc-feature-block-url-new-submit",function(t){t.preventDefault(),custom_label=e(".ppc-feature-block-url-new-name").val(),custom_link=e(".ppc-feature-block-url-new-link").val(),security=e(".ppc-feature-submit-form-nonce").val(),item_id="",item_id=(button=e(this)).closest("tr").find(".custom-edit-id").val(),e(".ppc-feature-submit-form-error").remove(),button.attr("disabled",!0),e(".ppc-feature-post-loader").addClass("is-active");var a={action:"ppc_submit_feature_blocked_url_by_ajax",security:security,custom_label:custom_label,custom_link:custom_link,item_id:item_id};e.post(ajaxurl,a,function(t){if("error"==t.status)button.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:red;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(2e3).fadeOut("slow");else{var a=e(".parent-menu.blockedbyurl"),s=e(".child-menu.blockedbyurl");e(".ppc-save-button-warning").remove(),e(".ppc-feature-block-url-new-name").val(""),e(".ppc-feature-block-url-new-link").val(""),button.closest("tr").find(".ppc-post-features-note").html('<div class="ppc-feature-submit-form-error" style="color:green;">'+t.message+"</div>"),e(".ppc-feature-submit-form-error").delay(5e3).fadeOut("slow"),setTimeout(function(){e(".ppc-menu-overlay-item").removeClass("ppc-menu-overlay-item")},5e3),s.length>0?""!==item_id?(button.closest("tr").find(".cancel-custom-features-item-edit").trigger("click"),e(".child-menu.blockedbyurl.custom-item-"+item_id).replaceWith(t.content)):e(".child-menu.blockedbyurl:last").after(t.content):a.after(t.content)}button.closest("form").find("input[type=submit]").attr("disabled",!1),e(".ppc-feature-post-loader").removeClass("is-active"),button.attr("disabled",!1)})}),e(document).on("click",".ppc-custom-features-url-delete",function(t){if(confirm(cmeAdmin.deleteWarning)){var a=e(this),s=a.attr("data-id"),c=e(".ppc-feature-submit-form-nonce").val();a.closest(".ppc-menu-row").fadeOut(300),e.post(ajaxurl,{action:"ppc_delete_feature_blocked_url_item_by_ajax",security:c,delete_id:s},function(e){"error"==e.status&&(a.closest(".ppc-menu-row").show(),alert(e.message))})}})});
